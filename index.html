<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#f1c40f">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Nenek Scooter">

    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="assets/img/icon-192.png">

    <title>Nenek Gaul Naik Scooter - Edisi Indonesia</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <div id="custom-cursor"></div>
    <script>
        const cursor = document.getElementById('custom-cursor');
        document.addEventListener('mousemove', (e) => {
            cursor.style.left = e.clientX + 'px';
            cursor.style.top = e.clientY + 'px';
        });
    </script>

    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="loading-content">
            <div class="loading-logo">
                <img src="assets/img/nenek1.webp" alt="Nenek" class="loading-character">
                <div class="loading-scooter-line"></div>
            </div>
            <h1>ğŸ›µ Nenek Gaul Scooter</h1>
            <p class="loading-subtitle">Edisi Indonesia</p>
            <div class="progress-container">
                <div id="load-progress" class="progress-bar"></div>
            </div>
            <p id="load-percent">0%</p>
            <p class="loading-tip">ğŸ’¡ Tekan Spasi atau Klik untuk lompat!</p>
        </div>
    </div>

    <div id="game-container" style="display: none;">
        <!-- Top UI Bar -->
        <div id="ui-container">
            <div class="hud-panel">
                <div class="score-group">
                    <div class="hud-item score">
                        <span class="hud-label">SKOR</span>
                        <span id="score-board">0</span>
                    </div>
                    <div class="hud-item highscore">
                        <span class="hud-label">TERTINGGI</span>
                        <span id="highscore-board">0</span>
                    </div>
                </div>
                <div id="lives-container">
                    <span id="hearts-display"></span>
                </div>
            </div>

        </div>

        <!-- Settings Button (top of everything) -->
        <button id="settings-btn" style="top: 80px;">âš™ï¸</button>

        <!-- Background Layers -->
        <div class="layer" id="bg-buildings"></div>
        <div class="layer" id="bg-shops"></div>
        <div class="layer" id="bg-pedestrians"></div>
        <div class="layer" id="bg-decor"></div>

        <!-- Entities are now dynamically added by JS -->

        <div id="overlay">
            <div class="intro-container">
                <img src="assets/img/nenek1.webp" alt="Nenek" class="intro-character">
                <h1 id="status-title">Nenek Gaul Scooter</h1>
                <p id="status-msg" class="intro-subtitle">Bantu Nenek mengumpulkan buah & hindari rintangan!</p>

                <div class="intro-items-grid">
                    <div class="intro-card collect">
                        <span class="card-label">âœ… AMBIL</span>
                        <div class="card-items">
                            <div class="card-item"><img src="assets/img/apple.webp" width="30"><span>+10</span></div>
                            <div class="card-item"><img src="assets/img/jeruk.webp" width="30"><span>+10</span></div>
                            <div class="card-item"><img src="assets/img/cherry.webp" width="30"><span>+15</span></div>
                        </div>
                    </div>
                    <div class="intro-card avoid">
                        <span class="card-label">âŒ HINDARI</span>
                        <div class="card-items">
                            <img src="assets/img/banana.webp" class="card-obstacle" alt="Pisang">
                            <img src="assets/img/hydrant.webp" class="card-obstacle" alt="Hydrant">
                            <img src="assets/img/kucing1.webp" class="card-obstacle" alt="Kucing">
                        </div>
                    </div>
                </div>

                <div class="intro-controls">
                    <span>â¬†ï¸ / SPASI = Loncat</span>
                    <span>â¸ï¸ = Pause</span>
                </div>

                <button class="btn" id="start-btn">ğŸ® MAIN SEKARANG</button>

                <!-- Main Menu Controls -->
                <div class="menu-controls">
                    <button id="login-btn" class="menu-icon-btn" title="Login with Google">ğŸ”‘</button>
                    <div id="user-profile" class="profile-chip" style="display: none;">
                        <img id="user-avatar" src="" alt="User">
                        <span id="user-name"></span>
                    </div>
                    <button id="leaderboard-btn" class="menu-icon-btn" title="Leaderboard">ğŸ†</button>
                    <button id="feedback-btn" class="menu-icon-btn" title="Feedback">ğŸ’¬</button>
                    <button id="donate-btn-menu" class="menu-icon-btn" title="Dukungan (Saweria)"
                        style="background: #f1c40f; color: #2d3436; border: 2px solid #d4ac0d;">ğŸ</button>
                </div>
            </div>
        </div>

        <!-- Game Over Overlay -->
        <div id="game-over-overlay" class="overlay" style="display: none;">
            <div class="glass-panel game-over-panel">
                <h1 class="game-over-title">GAME OVER</h1>
                <p class="game-over-msg" id="game-over-msg">Yaah, nabrak!</p>

                <div class="result-container">
                    <div class="result-box">
                        <span class="result-label">SKOR KAMU</span>
                        <span class="result-value" id="final-score">0</span>
                    </div>
                    <div class="result-box highscore-box">
                        <span class="result-label">RECORD</span>
                        <span class="result-value" id="final-highscore">0</span>
                    </div>
                </div>

                <div class="game-over-controls">
                    <button id="restart-btn" class="btn btn-primary">ğŸ”„ MAIN LAGI</button>
                    <button id="menu-btn" class="btn btn-secondary">ğŸ  MENU UTAMA</button>
                    <button id="donate-btn-over" class="btn btn-saweria" style="margin-top: 5px;">ğŸ DUKUNGAN
                        (SAWERIA)</button>
                </div>
            </div>
        </div>

        <!-- Settings Modal -->
        <div id="settings-modal" class="modal">
            <div class="modal-content glass-panel">
                <h2>âš™ï¸ Pengaturan</h2>
                <div class="setting-item">
                    <label>
                        <input type="checkbox" id="toggle-bgm" checked>
                        <span>ğŸµ Musik Latar (BGM)</span>
                    </label>
                </div>
                <div class="setting-item">
                    <label>
                        <input type="checkbox" id="toggle-sfx" checked>
                        <span>ğŸ”Š Efek Suara (SFX)</span>
                    </label>
                </div>
                <button class="btn" id="close-settings">âœ”ï¸ Simpan & Tutup</button>
            </div>
        </div>
    </div>

    <!-- Leaderboard Modal -->
    <div id="leaderboard-modal" class="modal">
        <div class="modal-content glass-panel" style="max-width: 500px; width: 90%;">
            <div class="modal-header">
                <h2>ğŸ† Hall of Fame</h2>
                <button class="close-icon close-modal" data-target="leaderboard-modal">&times;</button>
            </div>
            <div class="leaderboard-table-container custom-scrollbar">
                <table id="leaderboard-table">
                    <thead>
                        <tr>
                            <th width="15%">#</th>
                            <th>Player</th>
                            <th width="25%" style="text-align: right;">Score</th>
                        </tr>
                    </thead>
                    <tbody id="leaderboard-body">
                        <!-- Rows will be populated by JS -->
                        <tr>
                            <td colspan="3" style="text-align: center; padding: 20px;">Loading data...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Feedback Modal -->
    <div id="feedback-modal" class="modal">
        <div class="modal-content glass-panel" style="max-width: 400px;">
            <div class="modal-header">
                <h2>ğŸ’¬ Masukan & Saran</h2>
                <button class="close-icon close-modal" data-target="feedback-modal">&times;</button>
            </div>
            <p style="color: #dfe6e9; margin-bottom: 20px; text-align: center;">Bantu kami membuat game ini lebih seru!
            </p>

            <div class="form-group">
                <label>Kategori</label>
                <select id="feedback-category" class="glass-input">
                    <option value="suggestion">ğŸ’¡ Saran Fitur</option>
                    <option value="bug">ğŸ› Lapor Bug</option>
                    <option value="other">ğŸ“ Lainnya</option>
                </select>
            </div>

            <div class="form-group">
                <label>Pesan</label>
                <textarea id="feedback-message" class="glass-input" placeholder="Tulis pesanmu di sini..."
                    rows="4"></textarea>
            </div>

            <button id="submit-feedback-btn" class="btn btn-primary" style="width: 100%; margin-top: 10px;">Kirim
                Masukan</button>
        </div>
    </div>

    <script src="js/assets.js" type="module"></script>
    <script type="module" src="js/main.js"></script>
</body>

</html>